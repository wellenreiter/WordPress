<?php class wpSEO_License{public static function verify(){if(empty($_POST['_wpseo_action'])or $_POST['_wpseo_action'] !='verify' or empty($_POST['_wpseo_key'])){return false;}wpSEO::check_security(); $codes=array('false', 'true'); $status=(int)self::compare(md5(trim($_POST['_wpseo_key']))); $_REQUEST['_wp_http_referer']=network_admin_url('plugins.php'); wpSEO::redirect_referer(array('licensed'=> $codes[$status]));}public static function compare($key){$url=get_bloginfo('url'); $key=(string)$key; if(empty($key)or empty($url)or strlen($key)!=32){return false;}$response=wpSEO_Base::get_file(strrev('/yek/3v/ed.oespw.ipa//:ptth'), 'post', array('timeout'=> 120, 'body'=> array('key'=> urlencode($key), 'url'=> urlencode($url)))); if(is_wp_error($response)){wpSEO_Feedback::add('notice', $response->get_error_message()); return false;}$xml=simplexml_load_string($response); if(empty($xml)or !is_object($xml)){return false;}return self::_check(array('key'=> $key, 'by'=>(string)$xml->by, 'auth'=>(string)$xml->auth, 'type'=>(string)$xml->type));}public static function shame(){if(get_site_transient(strrev('esnecil_oespw'))){return;}$since=get_site_option(strrev('galf_llatsni_tluafed')); $data=get_site_option(strrev('esnecil_oespw')); if(empty($since)or round((time()- $since)/ 86400)> 28){if(empty($data)or empty($data['key'])or empty($data['by'])or empty($data['hash'])or !in_array(strlen($data['key']), array(32, 63))or strcasecmp(md5($data['key'].$data['by'].AUTH_KEY), $data['hash'])!=0){delete_site_option(strrev('esnecil_oespw')); if(!function_exists('deactivate_plugins')){require_once(ABSPATH. 'wp-admin/includes/plugin.php');}deactivate_plugins(WPSEO_BASE, true);}}set_site_transient(strrev('esnecil_oespw'), 'sergejliebtsweta', 60*60*24*30);}private static function _check($data){if(empty($data)){return false;}if(empty($data['auth'])or $data['auth'] !=md5(1)){return false;}if(is_multisite()&& strcasecmp($data['type'], 'f3d64714d1f6e7f71558d4252e84ab58')==0){return false;}return self::_save($data);}private static function _save($data){if(empty($data)){return false;}$key=@$data['key']; $by=@$data['by']; if(empty($key)or empty($by)){return false;}update_site_option(strrev('esnecil_oespw'), array('key'=> $key, 'by'=> $by, 'hash'=> md5($key.$by.AUTH_KEY))); return true;}private static function _status(){if($status=wp_cache_get('wpseo_status')){return $status;}$data=get_site_option(strrev('esnecil_oespw')); if(!empty($data['key'])&& !empty($data['by'])&& !empty($data['hash'])&&(in_array(strlen($data['key']), array(32, 63)))&& md5($data['key'].$data['by'].AUTH_KEY)==$data['hash']){$status=true;}else{delete_site_option(strrev('esnecil_oespw')); $since=get_site_option(strrev('galf_llatsni_tluafed')); $diff=round((time()- $since)/ 86400); $pos=strpos('sergej+sweta=love', 't'); $status=intval($pos - $diff);}wp_cache_set('wpseo_status', $status); return $status;}public static function trial(){$status=self::_status(); return(is_numeric($status)&& $status > 0 ? $status : false);}public static function expired(){return(self::_status()<=0);}public static function invalid(){return(self::trial()or self::expired());}public static function valid(){return !self::invalid();}}